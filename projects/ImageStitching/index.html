<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Image Stitching | Dayoon Suh </title> <meta name="author" content="Dayoon Suh"> <meta name="description" content="to create a panorama image"> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="/assets/img/star16.png?8313f39206cc4c988d004cc656add13a"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://dayoonsuh.github.io/projects/ImageStitching/"> <script src="/assets/js/theme.js?9a0c749ec5240d9cda97bc72359a72c0"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>initTheme();</script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> Dayoon Suh </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">Publications </a> </li> <li class="nav-item active"> <a class="nav-link" href="/projects/">Projects <span class="sr-only">(current)</span> </a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Image Stitching</h1> <p class="post-description">to create a panorama image</p> </header> <article> <p>Let’s create a panorama image!</p> <p>Given 2 photos of UT tower, we are going to stitch these two images to create a panorama image.</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/ImageStitching/data/uttower_left.jpg" sizes="95vw"></source> <img src="/assets/img/ImageStitching/data/uttower_left.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="example image" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/ImageStitching/data/uttower_right.jpg" sizes="95vw"></source> <img src="/assets/img/ImageStitching/data/uttower_right.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="example image" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p><br></p> <h2 id="steps-for-image-stitching">Steps for Image Stitching</h2> <ol> <li>Load the images into grayscale image</li> <li>Detect key points in both images</li> <li>Extract features for key points</li> <li>Match features between Images</li> <li>Calculate homography</li> <li>Refit with inliers</li> <li>Warp one image onto the other.</li> </ol> <p><br></p> <h2 id="details">Details</h2> <p><br></p> <h2 id="1-load-the-images-into-grayscale-image">1. Load the images into grayscale image</h2> <p>Load the images and convert them into grayscale image.</p> <p><br></p> <h2 id="2-detect-key-points-in-both-images">2. Detect key points in both images</h2> <p>Extract corner key points using Harris Corner Detector.</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/ImageStitching/best/img1_keypoint_vis.jpg" sizes="95vw"></source> <img src="/assets/img/ImageStitching/best/img1_keypoint_vis.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="example image" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/ImageStitching/best/img2_keypoint_vis.jpg" sizes="95vw"></source> <img src="/assets/img/ImageStitching/best/img2_keypoint_vis.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="example image" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p><br></p> <h2 id="3-extract-features-for-key-points">3. Extract features for key points</h2> <p>Extract local neighborhoods around every keypoint in both images.</p> <p><br></p> <h2 id="4-match-features-between-images">4. Match features between images</h2> <p>Once features are detected, match them across adjacent images. Compute L2 distances between every descriptor in one image and every descriptor in the other image. Then, select putative matches based on the matrix of pairwise descriptor distances.</p> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/ImageStitching/best/inlier_matches_pixel_crop.png" sizes="95vw"></source> <img src="/assets/img/ImageStitching/best/inlier_matches_pixel_crop.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="example image" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <p><br></p> <h2 id="5-calculate-homography">5. Calculate homography</h2> <p>With matched features, compute the homography matrix, which maps points from one image to the corresponding points in the next. To estimate the homography matrix, we use RANSAC algorithm. Why is RANSAC Needed for homography calculation? This is because when matching feature points between two images, not all matches are correct—some are outliers caused by noise, repeated patterns in the image, and errors in feature detection or matching. If these outliers are included in the homography computation, the resulting transformation will be inaccurate.</p> <h4 id="ransac-helps-by">RANSAC helps by:</h4> <ul> <li>Filtering out incorrect matches (outliers).</li> <li>Focusing on the most consistent matches (inliers).</li> </ul> <h4 id="how-ransac-is-used-in-calculating-homography">How RANSAC is used in calculating homography:</h4> <p>Given matched feature points between two images,</p> <ol> <li>Randomly select a small subset of matched points (usually 4, as 4 points are sufficient to calculate a homography).</li> <li>Compute a candidate homography matrix using these points.</li> <li>Measure how well the candidate homography aligns the rest of the points (based on a threshold for reprojection error).</li> <li>Keep the homography matrix that produces the highest number of inliers.</li> </ol> <p><br></p> <h2 id="6-refit-with-inliers">6. Refit with inliers</h2> <p>Once homography matrix and inliers are obtained, refit the homography matrix using only the inliers.</p> <p><br></p> <h2 id="7-warp-one-image-onto-the-other">7. Warp one image onto the other</h2> <p>Using the homography matrix obtained from previous step, warp images into the same coordinate space so that they align perfectly.</p> <p>Then, image stiching is done and we have our panorama image!</p> <p><br></p> <h2 id="using-hynet-descriptor">Using Hynet Descriptor</h2> <p>Instead of using pixel descriptor, we can use pre-trained HyNet descriptor. HyNet takes in a 32 × 32 patch and outputs a feature vector of size 128.</p> <p>Using Hynet feature descriptor gives us more accurate matched keypoints.</p> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/ImageStitching/best/inlier_matches_hynet_crop.png" sizes="95vw"></source> <img src="/assets/img/ImageStitching/best/inlier_matches_hynet_crop.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="example image" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <p><br> Hynet usually provides better results than that of using pixel descriptor with different parameter settings (patch size, number of iterations, threshold, etc.)</p> <p><br></p> <h2 id="results">Results</h2> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/ImageStitching/best/stitched_pixel.png" sizes="95vw"></source> <img src="/assets/img/ImageStitching/best/stitched_pixel.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="example image" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/ImageStitching/best/stitched_hynet.png" sizes="95vw"></source> <img src="/assets/img/ImageStitching/best/stitched_hynet.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="example image" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Left: pixel, Right: Hynet </div> </article> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2024 Dayoon Suh. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="external nofollow noopener">Unsplash</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>addBackToTop();</script> </body> </html>